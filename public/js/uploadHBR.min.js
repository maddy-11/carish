var uploadHBR = (function () {
    var e,
        a = 6,
        t = "Adicionar",
        n = "Clique ou arraste aqui uma foto",
        i = "Clique aqui para remover a foto",
        r = "fa fa-camera",
        s = "fa fa-times",
        o = ["image/jpeg", "image/png"],
        d = "Invalid File Extension.",
        l = !1,
        c = "error-selector",
        v = 0,
        y = "Too Big images will not be selected";
    function u(a) {
        var t = $(a).attr("data-index");
        $(e + " #base64_" + t).val(""),
            $(e + " #new_" + t).removeClass("hidden"),
            $(e + " #prev_" + t).addClass("hidden"),
            $(e + " #prev_" + t)
                .find("img")
                .attr("src", ""),
            $(a).find(".uploadArea").removeClass("selected"),
            $(a).removeClass("selected");
    }
    function f() {
        var a = null,
            t = document.querySelectorAll("#columns .column");
        function n(a, t) {
            var n = new FileReader();
            (n.onload = function (a) {
                $(e + " #prev_" + t)
                    .find("img")
                    .attr("src", a.target.result),
                    $(e + " #prev_" + t).removeClass("hidden"),
                    $(e + " #new_" + t).addClass("hidden"),
                    $(e + " #base64_" + t)
                        .val(a.target.result)
                        .change();
            }),
                n.readAsDataURL(a);
        }
        function i(a) {
            l && $("#" + c).hide();
            var t = 0; 
            $.each(a, function (a, i) {
                if(i.size > '9024000'){
                    $("#" + c).css('display', 'block'); 
                    $("#" + c).html('<h4>'+y+'</h4>'); 
                    return;
                }
                $.each(o, function (r, s) {
                    if ((l && ($("#" + c).html(""), $("#" + c).hide(), 0 == o.includes(i.type) && ($("#" + c).show(), $("#" + c).html(d))), void 0 !== $(e + " #base64_" + a).val() && s === i.type))
                        if (parseInt($(e + " #base64_" + a).val().length) > 0)
                            for (var v = 0, u = t + 1; u < $(e + ' input[name*="product_image"]').length; u++) v || 0 !== parseInt($(e + " #base64_" + u).val().length) || (n(i, u), (t = u), v++);
                        else n(i, a);
                });
            });
        }
        function r() {
            $(e + " .remove").click(function () {
                u(this);
            }),
                $(e + " .new").click(function () {
                    document.getElementById("hidden_" + $(this).attr("data-index")).click();
                }),
                $(e + " .fileHidden").change(function () {
                    i(this.files);
                }),
                $(e + " .uploadArea").on("dragend", function () {
                    $(this).removeClass("selected");
                }),
                $(e + " .uploadArea").on("dragleave", function () {
                    $(this).removeClass("selected");
                }),
                $(e + " .uploadArea").on("dragstart", function () {
                    $(this).addClass("selected");
                }),
                $(e + " .uploadArea").on("dragover", function (e) {
                    e.preventDefault(), e.stopPropagation(), $(this).addClass("selected");
                }),
                $(e + " .uploadArea").on("dragenter", function (e) {
                    e.preventDefault(), e.stopPropagation(), $(this).addClass("selected");
                }),
                $(e + " .uploadArea").on("drop", function (e) {
                    $(this).removeClass("selected"), e.originalEvent.dataTransfer && e.originalEvent.dataTransfer.files.length && (e.preventDefault(), e.stopPropagation(), i(e.originalEvent.dataTransfer.files));
                });
        }
        function s(a) {
            return a.preventDefault && a.preventDefault(), $(e + " .column").css("opacity", 1), $(this).find(".uploadArea").addClass("selected"), (a.dataTransfer.dropEffect = "move"), !1;
        }
        function v(e) {
            [].forEach.call(t, function (e) {
                e.classList.remove("over");
            });
        }
        function f(e) {
            this.classList.add("over"), e.preventDefault(), e.stopPropagation();
        }
        function p(a) {
            this.classList.remove("over"), $(e + " .uploadArea").removeClass("selected");
        }
        function g(e) {
            (this.style.opacity = "0.4"), (a = this), (e.dataTransfer.effectAllowed = "move"), e.dataTransfer.setData("text/html", this.innerHTML);
        }
        function m(t) {
            t.stopPropagation && t.stopPropagation(),
                null !== a && a !== this && ((a.innerHTML = this.innerHTML), (this.innerHTML = t.dataTransfer.getData("text/html")), $(e + " .uploadArea").removeClass("selected"), $(e + " .column").css("opacity", 1)),
                r();
        }
        [].forEach.call(t, function (e) {
            e.addEventListener("dragstart", g, !1),
                e.addEventListener("dragenter", f, !1),
                e.addEventListener("dragover", s, !1),
                e.addEventListener("dragleave", p, !1),
                e.addEventListener("drop", m, !1),
                e.addEventListener("dragend", v, !1);
        }),
            r();
    }
    return {
        init: function (u) {
            Modernizr.draganddrop
                ? (void 0 !== u.max && (a = parseInt(u.max)),
                  void 0 !== u.textNew && (t = u.textNew),
                  void 0 !== u.textTitle && (n = u.textTitle),
                  void 0 !== u.textTitleRemove && (i = u.textTitleRemove),
                  void 0 !== u.mimes && (o = u.mimes),
                  void 0 !== u.start && (v = u.start),
                  void 0 !== u.errorMessage && (d = u.errorMessage),
                  void 0 !== u.errorMessages && (y = u.errorMessages),
                  void 0 !== u.showExtensionError && (l = u.showExtensionError),
                  void 0 !== u.messageSelector && (c = u.messageSelector),
                  (function (d) {
                      e = d.target;
                      var l,
                          c,
                          u = $(d.target);
                      if (u.length > 0){
                          var i =1;
                          //console.log(d.errorMessages);
                          for (u.html(""); v < a; v++){
                              u.append(
                                  ((l = v),
                                  (c = void 0),
                                  (c = o.join(",")),
                                  '<div class="box-drag column" draggable="true"><input type="hidden" name="product_image[]" id="base64_' +
                                      l +
                                      '" data-id="' +
                                      l +
                                      '"><div class="form-group"><div class="col-md-12 no-padding uploadArea" data-index="' +
                                      l +
                                      '"><span class="new" id="new_' +
                                      l +
                                      '" title="' +
                                      n +
                                      '" data-index="' +
                                      l +
                                      '"><input type="file" class="fileHidden hidden" multiple="" accept="' +
                                      c +
                                      '" id="hidden_' +
                                      l +
                                      '" data-index="' +
                                      l +
                                      '"><i class="' +
                                      r +
                                      '"></i><p>' +
                                      t +
                                      '</p></span><span class="image-preview hidden" id="prev_' +
                                      l +
                                      '"><div class="remove" title="' +
                                      i +
                                      '" data-index="' +
                                      l +
                                      '"><i class="' +
                                      s +
                                      '"></i></div><img class="img-responsive" src=""></span></div></div></div>')
                              );i++;
                      }
                      }
                      else console.log("Target not found : " + d.target);
                  })(u),
                  f())
                : console.log("Modernizr not enabled");
        },
        reset: function (e) {
            var a = $(e);
            a.length > 0
                ? $.each($(a).find(".uploadArea"), function (e, a) {
                      u(this);
                  })
                : console.log("Target not found : " + e);
        },
    };
})();
